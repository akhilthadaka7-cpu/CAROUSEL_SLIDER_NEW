<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Full Card Infinite Carousel</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

<style>
body {
    font-family: Arial, sans-serif;
    padding: 40px;
    background: #fff;
}
.header {
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin-bottom:20px;
}
.header h2 {
    font-size:28px;
    margin:0;
}
.controls button {
    width:42px;
    height:42px;
    border-radius:50%;
    border:1px solid #ddd;
    background:#fff;
    font-size:18px;
    cursor:pointer;
}
.wrapper {
    overflow:hidden;
    width:100%;
}
.track {
    display:flex;
    gap:20px;
    will-change: transform;
}
.card {
    flex:0 0 auto;
}
.card img {
    width:100%;
    border-radius:20px;
    display:block;
}
.title {
    font-size:16px;
    margin-top:10px;
    font-weight:600;
}
.author {
    font-size:14px;
    color:#777;
}
</style>
</head>
<body>

<div class="header">
    <h2>You Might Like</h2>
    <div class="controls">
        <button id="prev">←</button>
        <button id="next">→</button>
    </div>
</div>

<div class="wrapper">
    <div class="track">
        <div class="card"><img src="https://picsum.photos/400/400?1"><div class="title">SmartLess</div><div class="author">Wondery</div></div>
        <div class="card"><img src="https://picsum.photos/400/400?2"><div class="title">Good Inside</div><div class="author">Dr Becky</div></div>
        <div class="card"><img src="https://picsum.photos/400/400?3"><div class="title">Planet Money</div><div class="author">NPR</div></div>
        <div class="card"><img src="https://picsum.photos/400/400?4"><div class="title">Stuff You Should Know</div><div class="author">iHeart</div></div>
        <div class="card"><img src="https://picsum.photos/400/400?5"><div class="title">Hidden Brain</div><div class="author">NPR</div></div>
        <div class="card"><img src="https://picsum.photos/400/400?6"><div class="title">Radiolab</div><div class="author">WNYC</div></div>
    </div>
</div>

<script>
$(function() {
    const track = $('.track');
    const wrapper = $('.wrapper');
    const gap = 20;
    const originalHTML = track.html();
    let visible = 4;
    let index = 0;
    let isAnimating = false;
    let auto;

    function getVisible() {
        const w = window.innerWidth;
        if (w >= 1200) return 4;
        if (w >= 992) return 3;
        if (w >= 758) return 2;
        return 1;
    }

    function setupCarousel() {
        clearInterval(auto);
        visible = getVisible();
        index = visible;

        track.html(originalHTML);

        const cards = track.children();
        const totalGap = gap * (visible - 1);
        const cardWidth = (wrapper.width() - totalGap) / visible;
        cards.css('width', cardWidth + 'px');

        // Clone buffer for seamless infinite scroll
        cards.slice(-visible).clone(true).prependTo(track);
        cards.slice(0, visible).clone(true).appendTo(track);

        const step = cardWidth + gap;

        track.css({
            transition: 'none',
            transform: `translateX(${-index * step}px)`
        });

        startAuto();
    }

    function move(dir) {
        if (isAnimating) return;
        isAnimating = true;

        const step = $('.card').outerWidth(true) + gap;
        index += dir; // move 1 card at a time

        track.css({
            transition: 'transform 0.6s ease',
            transform: `translateX(${-index * step}px)`
        });

        setTimeout(() => {
            const total = track.children().length;

            // Reset index for infinite loop
            if (index <= 0) index = total - visible * 2;
            if (index >= total - visible) index = visible;

            track.css({
                transition: 'none',
                transform: `translateX(${-index * step}px)`
            });

            isAnimating = false;
        }, 600);
    }

    $('#next').click(() => move(1));
    $('#prev').click(() => move(-1));

    function startAuto() {
        auto = setInterval(() => move(1), 3000);
    }

    wrapper.hover(
        () => clearInterval(auto),
        () => startAuto()
    );

    $(window).on('resize', setupCarousel);

    setupCarousel();
});
</script>

</body>
</html>
